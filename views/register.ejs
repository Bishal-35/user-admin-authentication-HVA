<link rel="stylesheet" href="/styles.css" />

<div class="container">
  <h2>Register</h2>

  <form onsubmit="registerUser(event)">
    <input id="name" placeholder="Name" required />
    <input id="email" placeholder="Email" required />
    <input id="password" type="password" placeholder="Password" required />
    <button type="submit">Register</button>
  </form>
  <div class="nav">
    <a href="/">Already have an account? Login here</a>
  </div>
</div>

<script>
  const token = sessionStorage.getItem("token");
  const role = sessionStorage.getItem("role");

  if (token) {
    alert("Please logout before registering a new user.");
    window.location = role === "admin" ? "/admin" : "/user";
  }
  
  async function registerUser(e) {
    e.preventDefault();

    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    const res = await fetch("/auth/register", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, email, password }),
    });

    const data = await res.json();
    alert(data.message);

    if (data.message === "User registered successfully") {
      window.location = "/";
    }
  }
</script>
