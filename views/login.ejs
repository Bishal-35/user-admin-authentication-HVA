<link rel="stylesheet" href="/styles.css" />

<div class="container">
  <h2>Login</h2>

  <form onsubmit="login(event)">
    <input id="email" type="text" placeholder="Email" required />
    <input id="password" type="password" placeholder="Password" required />
    <button type="submit">Login</button>
  </form>
  <div class="nav">
    <a href="/register">Don't have an account? Register here</a>
  </div>
</div>

<script>
  async function login(e) {
    e.preventDefault();

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    const res = await fetch("/auth/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password }),
    });

    const data = await res.json();
    if (data.token) {
      sessionStorage.setItem("token", data.token);

      if (data.role === "admin") window.location = "/admin";
      else window.location = "/user";
    } else {
      alert(data.message);
    }
  }
</script>
